***REMOVED*** Creator 工程原则

> **产品与架构目标**：按**顶级产品**打造 Creator。**持续去冗余、提升整体性能**；架构保持**高复用性、高扩展性、高清晰度**。  
> 开发中优先：**复利**、**模块化与可复用**、**降低复杂度**、**提高稳定性与可靠性**。每做一事，尽量让下一事更省力。

**顶级产品 / 架构三高（落地标准）**：

| 维度 | 标准 |
|------|------|
| **去冗余** | 主路径唯一、支线标清；无重复实现、无死代码；配置与文档收敛到少量入口。 |
| **整体性能** | 关键路径可观测（耗时、Token）；能缓存的检索/上下文做缓存；瓶颈可定位、可优化。 |
| **高复用性** | 通用能力以接口+实现分离；新场景优先组合现有模块，再考虑新增。 |
| **高扩展性** | 新能力通过扩展点接入（如新 mode、新记忆后端），不破坏主路径契约。 |
| **高清晰度** | 主路径/支线/依赖关系文档化；模块职责单一、命名一致；新人可快速定位。 |

---

***REMOVED******REMOVED*** 一、复利式工程（Compounding Engineering）

**原则**：每一件做完的事，都应让下一件同类事更容易。

| 做法 | 在 Creator 中的体现 |
|------|---------------------|
| **先投入再复用** | 写 PRD/设计时，先固化「理想结构」为模板或 prompt，之后只填核心内容即可生成；文档、接口契约同理。 |
| **自动化重复劳动** | 识别并自动化：多轮润色、实体提取、质量检查、回归测试等；用脚本/工作流替代手工，减少人为错误。 |
| **沉淀为资产** | 成功的 prompt、通用逻辑、可复用组件拆成独立模块或内部「库」；新需求优先查库再写新代码。 |

**落地**：新功能或重构前问一句——「做完这件事，下次类似需求能否直接复用或半自动完成？」若否，优先做一层抽象或工具再实现。

---

***REMOVED******REMOVED*** 二、模块化与可复用

**原则**：能复用的必须模块化；模块边界清晰、依赖单向。

| 做法 | 在 Creator 中的体现 |
|------|---------------------|
| **Prompt / 配置库** | 常用创作 prompt、校验规则、模型选用策略集中管理；新场景优先从库组合，而非重写长 prompt。 |
| **统一抽象再实现** | LLM 门面、创作记忆抽象、工具/技能注册层——主路径只依赖接口，具体实现可替换（降耦合、易测）。 |
| **拆解为独立能力** | 验证有效的逻辑（如检索、摘要、图谱合并）拆成可独立调用的模块或脚本，避免只存在于某一流程里。 |

**落地**：新增能力时先问——「能否作为通用模块被其他调用方复用？」若能，按接口+实现分离；若暂时不能，在注释或 README 中标明「后续可抽出」。

---

***REMOVED******REMOVED*** 三、降低复杂度

**原则**：少即是多；主路径唯一、支线标清；不堆叠平行方案。

| 做法 | 在 Creator 中的体现 |
|------|---------------------|
| **主路径唯一** | 创作入口只有 api/creator_handlers → react_novel_creator；workflow、puppeteer 标为实验/研究用，不承诺接入主产品。 |
| **收敛入口** | 配置、上下文、环境变量集中到少量入口；避免同一概念在多处定义、多处默认值。 |
| **删或归档冗余** | 未使用脚本、重复实现、过时文档定期清理或归档；每阶段去冗余（见 ROADMAP 阶段 A）。 |

**落地**：加新目录/新「套件」前问——「是否可与现有模块合并？若不能，是否会在心智上形成第二套主路径？」若是，优先收敛到现有主路径或明确标为实验。

---

***REMOVED******REMOVED*** 四、提高稳定性与可靠性

**原则**：行为可预期、失败可观测、回归可自动。

| 做法 | 在 Creator 中的体现 |
|------|---------------------|
| **契约稳定** | API、事件 payload、配置项有文档或类型；变更时兼容旧版或显式版本化，避免隐式破坏。 |
| **自动化回归** | 主路径有集成/端到端测试（如 api/test_creator_integration.py）；关键路径改动必跑，CI 可挂。 |
| **可观测** | 关键步骤有日志或事件；耗时、错误、Token 等可汇总（为后续告警、成本控制打基础）。 |

**落地**：改主路径或共享模块时——跑一遍主路径测试；改接口时——更新文档或类型并检查调用方。

---

***REMOVED******REMOVED*** 五、与 ROADMAP / 继续开发建议的关系

- **ROADMAP** 中的「阶段 A 去冗余、阶段 B 通用沉淀」直接对应：降复杂度 + 模块化可复用。
- **继续开发建议** 中的「收窄目标、主路径 vs 支线、测试与还债」对应：降复杂度 + 提稳定性。
- 本原则作为**日常开发时的取舍标准**：在具体需求与排期下，优先选择更符合复利、模块化、降复杂度、提稳定性的方案。

---

***REMOVED******REMOVED*** 六、一句话自检

**每次提交前可快速过一遍**：

- 这次改动是否让**下次**同类工作更简单（复利）？
- 新增逻辑是否**可复用**或已放入合适**模块**？
- 是否增加了**不必要的复杂度**（新入口、新平行实现、新概念）？
- 主路径或共享逻辑改动是否**可测、可回归**，契约是否**稳定**？
- 是否符合**顶级产品/架构三高**：去冗余、性能可观测、高复用/高扩展/高清晰？

若五项中有明显短板，优先补一补再合入（哪怕是小步：加一条测试、补一段 README、抽一个函数）。
